# plugingen.py -- Tools to generate plugins as luigi modules.

import plugin
import os
import sys
import datetime


def gen(plugin, f, wrappername):
    argnames=[]
    
    try:
        argnames=plugin.get_arg_names()
    except:
        argnames=argnames
    
    f.write("# Generated by ariadne on %s.\n" % datetime.date.today())
    f.write("import luigi\nimport os\n")
    f.write("class %s:\n" % wrappername)
    for a in argnames:
        f.write("    %s=luigi.Parameter()\n" % a)
    f.write("    def requires(self):\n")
    f.write("        return\n")
    f.write("    def run(self):\n")
    f.write("        os.system('ariadne.py plugin %s" % wrappername)
    for a in argnames:
        f.write(" "+a+"="+"'+self."+a+"+'")
    f.write("')\n")
    f.flush()